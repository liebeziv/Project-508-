Task1 答案
1. 这是可执行文件还是 DLL？
分析: 在 File Header 的 Characteristics 字段中，弹出的提示显示 "File is executable"。
答案: 这是一个可执行文件（.exe）。

2. NT Header/PE Header 从哪个地址开始？
分析: 在 DOS Header 部分，e_lfanew 字段（或称 File address of new exe header）的值指向了 PE Header 的起始地址。
答案: PE Header 的起始地址是 80（十六进制）。

3. 该 PE 文件包含多少个节以及它们是什么？
分析: 在 Section Headers 部分，可以清楚地看到一个包含所有节的列表。
答案: 该文件包含 3 个节，它们分别是 .text、.rsrc 和 .reloc。

4. 入口点地址是什么？
分析: 在 Optional Header 部分，AddressOfEntryPoint 字段的值就是入口点地址。在 PE-Bear 中，该字段显示为 Entry Point。
答案: 入口点地址是 6B4E。

5. 该二进制文件导入和导出了哪些函数？
分析:
在 Imports 部分，该文件从 mscoree.dll 导入了一个名为 _CorExeMain 的函数。
在 Exports 部分，该列表为空。
答案: 该文件从 mscoree.dll 导入了 _CorExeMain 函数，但没有导出任何函数。

6. 该文件能否处理大型地址集？
分析: 有多处证据可以证明：
File Header 的 Characteristics 字段提示 "App can handle >2gb addresses"。
Optional Header 的 Dll Characteristics 字段提示 "Image can handle a high entropy 64-bit virtual address"。
Optional Header 的 Magic 字段值为 10B，表示这是一个 32 位可执行文件，能够处理大于 2GB 的地址空间。
答案: 该文件能够处理大型地址集。

Task2 答案
rule ransomware1_rule
{
  meta:
      author = "Zhengrong Chen"
      description= "依照字符串和文件的属性检测可执行文件ransomware1.exe."
      date = "2025-08-25"
      version = "1.0"

  strings:
      $s1 = "mscoree.dll" wide ascii
      $s2 = "_CoreExeMain" wide ascii

  condition:
      ($s1 and $ s2) and
      pe.entry_point == 0x6B4E and
      pe.number_of_ssections == 3  and
      sha256(0) == "a872d7b04d9d3e9ace68ea1524d278bf35a24a4a1f9ec9f067cdfaf34a88c8a4"

}

Task3答案
1.XZ Utils后门是一种复杂的供应链攻击，其核心思想是将恶意代码秘密地植入一个广泛使用的开源库中，从而使攻击者能够获得大量系统的远程控制。
Exploitation：攻击者通过在版本5.6.0和5.6.1的XZ Utils库中植入恶意代码来利用这一漏洞。这个代码被巧妙地隐藏在压缩的测试文件内，只有在特定的编译环境下才会被激活。当被攻击的Linux系统启动时，sshd(OpenSSH server daemon）会加载被篡改的liblzma库。恶意代码通过利用glibc IFUNC机制，劫持了OpenSSH的一个函数（RSA_public_decrrypt)，使其能够执行攻击者的代码。
Impact：该后门程序可以让攻击者在拥有特定私钥的情况下，绕过SSH认证，并在受影响的系统上远程执行任意代码，并且获得root权限。这意味着攻击者可以完全控制受感染的机器，包括窃取数据，安装其他恶意软件，或发起进一步攻击，对全球无数服务器构成严重威胁。

2.这个漏洞是由微软的工程师和PostgreSQL开发者Andres Freund在一次例行调查中偶然发现的。
例行调查：Freund在调查Debian Sid系统上的性能问题时，注意到sshd进程的CPU使用率异常高，且Valgrind报告了奇怪的错误。
深入调查：这引起了Freund的警觉。他进一步深入调查，最终追踪到了libsystem库，并发现了代码被篡改，进而发现了隐藏在xz库中的恶意后门。
及时公布：Freund在2024年3月29日将他的发现公开在Openwall邮件列表上，该行为引起了全球范围内使用者的警觉和响应，有效阻止了该后门在其他系统上的部署和利用。

Task4答案：
搜索结果来源于VirusTotal
Hash1: 054314733888215dd469adcbdee14d46
威胁类别：Trojan和ransomware。是encoder属于lockbit家族。
行为解释：
  文件行为：作为勒索软件，最主要的文件系统行为是加密。这类恶意软件会遍历受害者计算机上的文件和目录，对重要文件进行加密。
  注册表：勒索软件通常会修改注册表实现持久化，并在系统中写入对应的赎金路径，指引受害者如何支付赎金。

Hash2: d3adaf9006e37df3eed462ec9dee7eef30ac36e9
威胁类别：Click-fraud，以及无文件恶意软件。属于Kovter恶意软件家族
行为解释：
  文件行为：Kovter的特点是无文件。意味着在多数情况下，不依赖于系统上的可执行文件作为其主要恶意载荷。
  注册表：该恶意软件利用了注册表作为其主要储存和执行机制。它会修改注册表键，并且将恶意代码注入其中，从而实现持久化的存在。主要功能是通过
  这些注册表在后台执行点击欺诈活动。

Task5答案：
1.代码1：加密和数据持久化
该代码实现了两种核心功能：数据加密和密钥持久化
加密：代码使用了RijndaeManaged类来生成密钥（Rij.GenerateKey())以及初始化向量(Rij.GenerateIV())。使用一个名为encryptAES的函数对
输入数据bhytes进行加密。这是一种对称加密算法，常用于勒索软件加密文件。
持久化：代码通过Registry.CurrentUsser.OpenSubKey("Software\Microsoft", true);打开Windows注册表键。然后，它将生成的加密密钥和IV值
分别以“KeyValue”和“IVvalue”的形式写入这个新创建的注册表键中。这种行为旨在保存加密所需的关键信息，以便恶意软件在后续运用时的使用。

2.代码2：反虚拟机检测
该代码实现了反虚拟机（Anti-VM）功能
代码通过调用CreateToolhelp32Snapshot和Process32First/Process32Next函数来遍历所有正在运行中的进程。
在if语句中，它检查每个进程中的可执行文件名(pe32.szExeFile)是否包含"VMware"或是“Vbox"。常见的虚拟机都会包含这类名称。
如果检测到对应的字符串，
